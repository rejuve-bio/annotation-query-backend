# Title: BioCypher graph schema configuration file

position entity:
  represented_as: node
  is_a: biological entity
  input_label: position_entity
  description: >-
      A biological entity that is defined by its position in the genome
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)
    chr: str
    start: int
    end: int
    source: str
    source_url: str


coding element:
  represented_as: node
  is_a: position entity
  inherit_properties: true
  input_label: coding_element
  description: >-
      A region of a gene that codes for a protein or peptide
  # properties:
  #   source: str
  #   source_url: str


non coding element:
  represented_as: node
  is_a: position entity
  inherit_properties: true
  input_label: non_coding_element
  description: >-
    A region of a gene that does not code for a protein or peptide
  properties:
    biological_context: str
    source: str
    source_url: str


genomic variant:
  represented_as: node
  is_a: position entity
  inherit_properties: true
  input_label: genomic_variant
  description: >-
      A genomic variant is a change in one or more sequence of a genome
  # properties:
  #   source: str
  #   source_url: str


annotation:
  is_a: related to at concept level
  represented_as: edge
  input_label: annotation
  description: >-
    An association between a gene/ontology term and another entity
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)
    source: str
    source_url: str

subclass of:
  is_a: annotation
  inherit_properties: true
  represented_as: edge
  input_label: subclass_of
  source: ontology term
  target: ontology term
  properties:
    rel_type: str

regulatory association:
  is_a: related to at instance level
  #inherit_properties: true
  represented_as: edge
  input_label: regulatory_association
  Source: gene
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)
    source: str
    source_url: str


# Fly:
# The unique ID for a library (or cluster) at Flybase is its FBlc#
# This schema could be used to represent a RNA-seq library, cluster or sample. Flybase uses FBlc# ids for:
#
#                         cluster               single cell
#                         cluster_analysis      single cell
#                         sample                high-throughput expression data
#                         dataset               high-throughput expression data
#                         RNASource library     RNA-seq RPKM
#                         parent library
#
# Flybase has assigned FBlc# ids to Fly Cell Atlas 2 tissues (libraries):
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#RNA-Seq_RPKM_values_matrix_.28gene_rpkm_matrix_fb_.2A.tsv.gz.29
#
# Fly Cell Atlas 2 data:
#
# Aging Fly Cell Atlas data:
#
# Flybase  data:
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#High-Throughput_Gene_Expression_.28high-throughput_gene_expression_fb_.2A.tsv.gz.29
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Single_Cell_RNA-Seq_Gene_Expression_.28scRNA-Seq_gene_expression_fb_.2A.tsv.gz.29
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#RNA-Seq_RPKM_values_.28gene_rpkm_report_fb_.2A.tsv.gz.29

rnaseq library:
  is_a: entity
  represented_as: node
  inherit_properties: false
  input_label: rnaseq_library
  description: >-
      A library/cluster/sample that is a set of genes and their expression values.
  properties:
    name: str
    experiment_info: str[]
    tissue_info: str[]
    cell_type_id: FBbt                   # cell type ontology id: str should be replaced by an ontology type  @todo
    anatomy_entity_id: [fbbt, uberon, cl]
    taxon_id: int                        # 7227 for dmel / 9606 for hsa
    source: str
    source_url: str


expression value:
  is_a: entity
  represented_as: edge
  inherit_properties: false
  input_label: expression_value
  source: [transcript, gene]
  target: rnaseq library
  description: >-
    A set of values for numeric estimation of single gene/transcript expression as measured by a given methodology (represented by a library).
  properties:
    value_and_description: list[tuple]]   # this list of tuples is to keep semantics in the DAS context.
                                          # it is (value, description), (value, description),...
                                          # where value is a gene (or transcript) expression value and description is
                                          # an acronym or a term or a text to clarify the expression value: "RPKM", "BIN VALUE", "SPREAD", etc.

    taxon_id: int                        # 7227 for dmel / 9606 for hsa
    source: str
    source_url: str


# For Fly this is used only to establish the relation. No value is held in the properties. 
expressed in:
  description: >-
    holds between a gene and an ontology term in which it is expressed
  is_a: expression
  inherit_properties: true
  represented_as: edge
  input_label: expressed_in
  source: gene
  target: ontology term           # Holds instances of Fbbt, FBdv, FBcv or GO
  properties:
    score: float
    p_value: float

# Fly:
#
# Flybase (FB) gtf: https://ftp.flybase.org/genomes/dmel/current/gtf/  ← it doesn’t list gene/transcript types
#
# this table holds fly genes with the transcript types data:
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#FBgn_.3C.3D.3E_FBtr_.3C.3D.3E_FBpp_IDs_.28expanded.29_.28fbgn_fbtr_fbpp_expanded_.2A.tsv.29 
#
#
# From Ensembl:
# https://ftp.ensembl.org/pub/current_gtf/drosophila_melanogaster/Drosophila_melanogaster.BDGP6.46.112.gtf.gz
# https://ftp.ensembl.org/pub/current_gtf/drosophila_melanogaster/README 
#
# or:  https://ftp.ebi.ac.uk/ensemblgenomes/pub/metazoa/current/gtf/drosophila_melanogaster/ 
#

# FB summaries come from:
  # https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Best_gene_summaries_.28best_gene_summary.2A.tsv.29

# Human summaries come from NCBI:
  #
#
#
gene:
  represented_as: node
  preferred_id: ensemble        # ensembl ids are FB FBgn# ids
  input_label: gene
  is_a: coding element
  inherit_properties: true
  properties:
    gene_name: str        # In FB this is the gene symbol (eg “Clk”) whereas the gene name is “Clock”.
    gene_type: str
    sequence: str         # nucleotide sequence
    synonyms:  str[]
    summary: str          # best available summary of information about a gene
    summary_source: str
    taxon_id: int                        # 7227 for dmel / 9606 for hsa


# Human: 
#
# https://ftp.uniprot.org/pub/databases/uniprot/current_release/knowledgebase/taxonomic_divisions/uniprot_sprot_human.dat.gz
# https://ftp.uniprot.org/pub/databases/uniprot/current_release/knowledgebase/taxonomic_divisions/uniprot_trembl_human.dat.gz 
#
# Fly:
# https://ftp.uniprot.org/pub/databases/uniprot/current_release/knowledgebase/taxonomic_divisions/uniprot_sprot_invertebrates.dat.gz 
# FB gene symbols are suffixed with "_DROME"
#
# Flybase (this is an alternative and it was not transformed to MeTTa):
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#FBgn_.3C.3D.3E_DB_Accession_IDs_.28fbgn_NAseq_Uniprot_.2A.tsv.29 
# https://ftp.flybase.org/releases/current/precomputed_files/collaborators/ 
#
# 2.3)
protein:
  represented_as: node
  preferred_id: uniprot                
  input_label: protein
  is_a: coding element                # it should not be a “coding element” neither a “non coding element” considering their descriptions
  inherit_properties: true
  properties:
    accessions: str[]
    protein_name: str
    dbxrefs: str[]                    # ids for related dbs and ontologies
    # source: str
    # source_url: str




#        →→→→        same as Gene  type for dmel and hsa (except the adapter)        ←←←←
#
# Human:
# https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_46/gencode.v46.annotation.gtf.gz 
#
# Maybe the “latest_release” could be better:
# https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/latest_release/gencode.v46.annotation.gtf.gz 
# Fly:
#
# Flybase (FB) gtf: https://ftp.flybase.org/genomes/dmel/current/gtf/  ← it doesn’t list gene/transcript types
#
# this table holds fly genes with the transcript types data:
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#FBgn_.3C.3D.3E_FBtr_.3C.3D.3E_FBpp_IDs_.28expanded.29_.28fbgn_fbtr_fbpp_expanded_.2A.tsv.29 
#
#
# From Ensembl:
# https://ftp.ensembl.org/pub/current_gtf/drosophila_melanogaster/Drosophila_melanogaster.BDGP6.46.112.gtf.gz
# https://ftp.ensembl.org/pub/current_gtf/drosophila_melanogaster/README 
#
# or:  https://ftp.ebi.ac.uk/ensemblgenomes/pub/metazoa/current/gtf/drosophila_melanogaster/ 
#
# Adapter: gencode_transcript_adapter
#
# 2.4)
transcript:
  represented_as: node
  input_label: transcript
  is_a: coding element
  inherit_properties: true
  properties:
    #gene_name: str
    gene: gene                #  to link to gene
    transcript_name: str
    #transcript_id: str
    transcript_type: str
  description: >-
    An RNA synthesized on a DNA or RNA template by an RNA polymerase.
  exact_mappings:
    - SO:0000673
    - SIO:010450
    - WIKIDATA:Q7243183
    - dcid:RNATranscript
  in_subset:
    - model_organism_database



#        →→→→        same as Gene  type for dmel and hsa (except the adapter)                ←←←←
#
# Human:
# https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_46/gencode.v46.annotation.gtf.gz 
#
# Maybe the “latest_release” could be better:
# https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/latest_release/gencode.v46.annotation.gtf.gz 
# Fly:
#
# Flybase (FB) gtf: https://ftp.flybase.org/genomes/dmel/current/gtf/  ← it doesn’t list gene/transcript types
#
# this table holds fly genes with the transcript types data:
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#FBgn_.3C.3D.3E_FBtr_.3C.3D.3E_FBpp_IDs_.28expanded.29_.28fbgn_fbtr_fbpp_expanded_.2A.tsv.29 
#
#
# From Ensembl:
# https://ftp.ensembl.org/pub/current_gtf/drosophila_melanogaster/Drosophila_melanogaster.BDGP6.46.112.gtf.gz
# https://ftp.ensembl.org/pub/current_gtf/drosophila_melanogaster/README 
#
# or:  https://ftp.ebi.ac.uk/ensemblgenomes/pub/metazoa/current/gtf/drosophila_melanogaster/ 
#
# Adapter: gencode_exon_adapter
#
# 2.5)
exon:
  represented_as: node
  preferred_id: ensemble
  input_label: exon
  is_a: coding element
  inherit_properties: true
  properties:
    gene: gene
    transcript: transcript
    exon_number: int
    #exon_id: str


transcript_to_exon:
  is_a: related to at instance level
  description: >-
    An association between a transcript and its exons
  represented_as: edge
  input_label: includes
  source: transcript
  target: exon
  properties: 
    source: str
    source_url: str

    
# ---
# genomic variants

# Fly:
# FB https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Alleles_.3C.3D.3E_Genes_.28fbal_to_fbgn_fb_.2A.tsv.29 
allele:
  represented_as: node
  input_label: allele
  is_a: genomic variant
  inherit_properties: true
  properties:
      #gene: gene
      allele_symbol: str
      taxon_id: int                        # 7227 for dmel / 9606 for hsa
  description: >-
      Different versions of the same variant (in a specific  locus) are called alleles[1, 2]. Most commonly used referring to genes.


# FB https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Alleles_.3C.3D.3E_Genes_.28fbal_to_fbgn_fb_.2A.tsv.29 
# Used in the allele_adapter.py  for dmel data
allele to gene association:
  is_a: annotation
  inherit_properties: true
  represented_as: edge
  input_label: variant_of
  source: allele
  target: gene
  properties:
    taxon_id: str   # 7227 for dmel


# —-------------------------------------------------------------------------------------------------------------------------------------
# Ontologies
# —-------------------------------------------------------------------------------------------------------------------------------------


# http://purl.obolibrary.org/obo/go.owl 
# 5.1)
# Gene Ontology

go subclass of:
  is_a: subclass of
  inherit_properties: true
  represented_as: edge
  input_label: go_subclass_of
  output_label: go_subclass_of
  source: go
  target: go

# Subclass relationships within GO subontology
#saulo
biological process subclass:
  is_a: go subclass of
  inherit_properties: true
  represented_as: edge
  input_label: biological_process_subclass_of
  # output_label: subclass_of
  source: biological_process
  target: biological_process

molecular_function_subclass:
  is_a: go subclass of
  inherit_properties: true
  represented_as: edge
  input_label: molecular_function_subclass_of
  # output_label: subclass_of
  source: molecular_function
  target: molecular_function

cellular_component_subclass:
  is_a: go subclass of
  inherit_properties: true
  represented_as: edge
  input_label: cellular_component_subclass_of
  # output_label: subclass_of
  source: cellular_component
  target: cellular_component


# Flybase development ontology (FBdv#)
FBdv:
  is_a: ontology term
  represented_as: node
  input_label: FBdv
  inherit_properties: true

# Flybase gross anatomy ontology (FBbt#)
FBbt:
  is_a: ontology term
  represented_as: node
  input_label: FBbt
  inherit_properties: true

# Flybase Controlled Vocabulary ontology (FBcv#)
FBcv:
  is_a: ontology term
  represented_as: node
  input_label: FBcv
  inherit_properties: true

# Molecular interactions ontology (MI)
mi:
  is_a: ontology term
  represented_as: node
  input_label: mi
  inherit_properties: true

# Sequence ontology (SO)
so:
  is_a: ontology term
  represented_as: node
  input_label: so
  inherit_properties: true

# https://purl.obolibrary.org/obo/doid.owl
# disease ontology
do:
  is_a: ontology term
  inherit_properties: true
  represented_as: node
  input_label: do



# —-------------------------------------------------------------------------------------------------------------------------------------
# Associations
# —-------------------------------------------------------------------------------------------------------------------------------------



# 7.1)
expression:
  is_a: related to at instance level
  represented_as: edge
  input_label: expression
  description: >-
    An association between a gene and its expression constituents
  source: gene
  target: [transcript, exon, protein]
  properties:
    source: str
    source_url: str
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)



# 7.4)
# FB: https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#FBgn_.3C.3D.3E_FBtr_.3C.3D.3E_FBpp_IDs_.28expanded.29_.28fbgn_fbtr_fbpp_expanded_.2A.tsv.29 
transcribed to:
  represented_as: edge
  is_a: expression
  inherit_properties: true
  input_label: transcribed_to
  source: gene
  target: transcript
  description: >-
    inverse of transcribed from
  exact_mappings:
    - RO:0002511
    - SIO:010080


# 7.5)
# FB: https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#FBgn_.3C.3D.3E_FBtr_.3C.3D.3E_FBpp_IDs_.28expanded.29_.28fbgn_fbtr_fbpp_expanded_.2A.tsv.29 
transcribed from:
  is_a: expression
  inherit_properties: true
  represented_as: edge
  input_label: transcribed_from
  source: transcript
  target: gene
  description: >-
    x is transcribed from y if and only if x is synthesized from template y
  exact_mappings:
    - RO:0002510
    - SIO:010081


# 7.6)
# FB: https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#FBgn_.3C.3D.3E_FBtr_.3C.3D.3E_FBpp_IDs_.28expanded.29_.28fbgn_fbtr_fbpp_expanded_.2A.tsv.29 
translates to:
  is_a: expression
  inherit_properties: true
  represented_as: edge
  input_label: translates_to
  source: transcript
  target: protein
  inverse: translation of
  description: >-
    x (amino acid chain/polypeptide) is the ribosomal translation of y (transcript) if and only if a ribosome
    reads y (transcript) through a series of triplet codon-amino acid adaptor activities (GO:0030533)
    and produces x (amino acid chain/polypeptide)
  close_mappings:
    - RO:0002513
    - SIO:010082


# 7.7)
# FB: https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#FBgn_.3C.3D.3E_FBtr_.3C.3D.3E_FBpp_IDs_.28expanded.29_.28fbgn_fbtr_fbpp_expanded_.2A.tsv.29 
translation of:
  is_a: expression
  inherit_properties: true
  represented_as: edge
  input_label: translation_of
  source: protein
  target: transcript
  description: >-
    inverse of translates to
  inverse: translates to
  close_mappings:
    - RO:0002512
    - SIO:010083


# 7.9)
# These files list         protein1_id        protein2_id        combined_score
# dmel: https://stringdb-downloads.org/download/protein.links.v12.0/7227.protein.links.v12.0.txt.gz 
# hsa:  https://stringdb-downloads.org/download/protein.links.v12.0/9606.protein.links.v12.0.txt.gz 
# todo
# merge data from STRING and FB physical interaction
post translational interaction:
  is_a: expression
  inherit_properties: true
  represented_as: edge
  input_label: interacts_with
  source: protein
  target: protein
  properties:
    score: float    # STRING DB score    
    source_gene: gene       
    target_gene: gene       
    detection_method: mi    # Molecular Interaction Ontology
    pubmed_ids: str[]
    source_taxon_id: int
    target_taxon_id: int
    interaction_type: mi    # Molecular Interaction Ontology
    interaction_comments: str
    source_comments: str
    target_comments: str    


# Schema for RNA-protein and protein-protein interactions.
# Biocypher doesn't accept source AND targets as lists of types in the same schema
# # ptp stands for "protein or transcript to protein"
ptp physically interacts with:
  is_a: expression
  inherit_properties: true
  represented_as: edge
  input_label: ptp_physically_interacts_with
  source: [protein, transcript]
  target: protein
  properties:
    source_gene: gene       
    target_gene: gene       
    detection_method: mi    # Molecular Interaction Ontology
    pubmed_ids: str[]
    source_taxon_id: int
    target_taxon_id: int
    interaction_type: mi    # Molecular Interaction Ontology
    interaction_comments: str
    source_comments: str
    target_comments: str    


# Schema for protein-RNA and RNA-RNA dmel physical interaction:
# ptt stands for "protein or transcript to transcript"
ptt physically interacts with:
  is_a: expression
  inherit_properties: true
  represented_as: edge
  input_label: ptt_physically_interacts_with
  source: [protein, transcript]
  target: transcript   
  properties:
    source_gene: gene       
    target_gene: gene       
    detection_method: mi    # Molecular Interaction Ontology
    pubmed_ids: str[]
    source_taxon_id: int
    target_taxon_id: int
    interaction_type: mi    # Molecular Interaction Ontology
    interaction_comments: str
    source_comments: str
    target_comments: str    


# 7.23)
# This holds data from TFLink to fly: https://cdn.netbiol.org/tflink/download_files/TFLink_Drosophila_melanogaster_interactions_All_simpleFormat_v1.0.tsv 
transcription factor to gene association:
  description: >-
    An regulatory association between a transcription factor and its target gene
  is_a: regulatory association
  inherit_properties: true
  represented_as: edge
  input_label: transcription_factor_of
  # output_label: regulates
  source: gene
  target: gene
  properties:
    evidence: str[]
    detection_method: str
    databases: str[]
    evidence_type: str


# Dmel to hsa data:

  #                   *** THE TABLE ONLY REPORTS HOMOLOGY WITH DIOPT SCORE GREATER THAN 2 ***
  #                   https://fgr.hms.harvard.edu/diopt-documentation

# From FB:  https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Human_Orthologs_.28dmel_human_orthologs_disease_fb_.2A.tsv.gz.29
# FB table columns:
# Dmel_gene_ID	Dmel_gene_symbol	Human_gene_HGNC_ID	Human_gene_OMIM_ID	Human_gene_symbol	DIOPT_score	OMIM_Phenotype_IDs	OMIM_Phenotype_IDs[name]
# orthology association:
#   description: >-
#   Non-directional association between two genes indicating that there is an orthology relation among them:  “Historical homology that involves genes that diverged after a speciation event (http://purl.obolibrary.org/obo/RO_HOM0000017)"
#   is_a: related to at instance level
#   #inherit_properties: true
#   represented_as: edge
#   input_label: orthologs_genes
#   source: gene
#   target: gene
#   properties:
#     DIOPT_score: int
#     hsa_hgnc_id: str
#     hsa_omim_id: str
#     hsa_omim_phenotype_ids: str
#     hsa_omim_phenotype_ids_names: str
#     source_organism: str
#     target_organism: str
#     #taxon_id: int                        # 7227 for dmel / 9606 for hsa




# Human:
#
# Fly:
#
# From FB:  https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Drosophila_Paralogs_.28dmel_paralogs_fb_.2A.tsv.gz.29

  #                   *** THE TABLE ONLY REPORTS HOMOLOGY WITH DIOPT SCORE GREATER THAN 2 ***
  #                   https://fgr.hms.harvard.edu/diopt-documentation

# FB table columns:
## FBgn_ID	GeneSymbol	Arm/Scaffold	Location	Strand	Paralog_FBgn_ID	Paralog_GeneSymbol	Paralog_Arm/Scaffold	Paralog_Location	Paralog_Strand	DIOPT_score
paralogy association:
  description: >-
  Non-directional association between two genes indicating that there is an paralogy relation among them:  “Historical homology that involves genes that diverged after a duplication event (http://purl.obolibrary.org/obo/RO_HOM0000011)"
  is_a: related to at instance level
  #inherit_properties: true
  represented_as: edge
  input_label: paralogs_genes
  source: gene
  target: gene
  properties:
    source_symbol: str
    target_symbol: str
    DIOPT_score: int
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)



# Reactome data
pathway:
  is_a: biological process
  exact_mappings:
    - PW:0000001
    - WIKIDATA:Q4915012
  narrow_mappings:
    - SIO:010526
    - GO:0007165
  represented_as: node
  input_label: pathway
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)
    pathway_name: str
    evidence: str


# Reactome data
gene to pathway association:
  description: >-
    An interaction between a gene or gene product and a biological process or pathway.
  is_a: annotation
  inherit_properties: true
  represented_as: edge
  input_label: genes_pathways
  source: [gene, protein, transcript]
  #source: gene
  target: pathway


# 7.11)
parent pathway of:
    is_a: annotation
    inherit_properties: true
    description: >-
      holds between two pathways where the domain class is a parent pathway of the range class
    represented_as: edge
    input_label: parent_pathway_of
    source: pathway
    target: pathway


# 7.12)
child pathway of:
    is_a: annotation
    inherit_properties: true
    description: >-
      holds between two pathways where the domain class is a child pathway of the range class
    represented_as: edge
    input_label: child_pathway_of
    source: pathway
    target: pathway


FBdv subclass of:
  is_a: subclass of
  inherit_properties: true
  represented_as: edge
  input_label: FBdv_subclass_of
  # output_label: subclass_of
  source: FBdv
  target: FBdv

FBbt subclass of:
  is_a: subclass of
  inherit_properties: true
  represented_as: edge
  input_label: FBbt_subclass_of
  # output_label: subclass_of
  source: FBbt
  target: FBbt

FBcv subclass of:
  is_a: subclass of
  inherit_properties: true
  represented_as: edge
  input_label: FBcv_subclass_of
  # output_label: subclass_of
  source: FBcv
  target: FBcv

mi subclass of:
  is_a: subclass of
  inherit_properties: true
  represented_as: edge
  input_label: mi_subclass_of
  # output_label: subclass_of
  source: mi
  target: mi

so subclass of:
  is_a: subclass of
  inherit_properties: true
  represented_as: edge
  input_label: so_subclass_of
  # output_label: subclass_of
  source: so
  target: so

do subclass of:
  is_a: subclass of
  inherit_properties: true
  represented_as: edge
  input_label: do_subclass_of
  # output_label: subclass_of
  source: do
  target: do


ontology term:
  is_a: ontology class
  represented_as: node
  input_label: ontology term
  properties:
    id: str
    term_name: str
    description: str
    synonyms: str[]
    source: str
    source_url: str


# coding elements
gene:
  represented_as: node
  preferred_id: ensemble
  input_label: gene
  is_a: coding element
  inherit_properties: true
  properties:
    gene_name: str
    gene_type: str
    synonyms: str[]

protein:
  represented_as: node
  preferred_id: uniprot
  input_label: protein
  is_a: coding element
  inherit_properties: true
  properties:
    accessions: str[]
    protein_name: str
    synonyms: str[]
    source: str
    source_url: str

transcript:
  represented_as: node
  input_label: transcript
  is_a: coding element
  inherit_properties: true
  properties:
    gene_name: str
    transcript_name: str
    transcript_id: str
    transcript_type: str
  description: >-
    An RNA synthesized on a DNA or RNA template by an RNA polymerase.
  exact_mappings:
    - SO:0000673
    - SIO:010450
    - WIKIDATA:Q7243183
    - dcid:RNATranscript
  in_subset:
    - model_organism_database

exon:
  represented_as: node
  preferred_id: ensemble
  input_label: exon
  is_a: coding element
  inherit_properties: true
  properties:
    gene_id: str
    transcript_id: str
    exon_number: int
    exon_id: str

pathway:
  is_a: biological process
  exact_mappings:
    - PW:0000001
    - WIKIDATA:Q4915012
  narrow_mappings:
    - SIO:010526
    - GO:0007165
  represented_as: node
  input_label: pathway
  properties:
    pathway_name: str
    evidence: str
    source: str
    source_url: str


# Gene Ontology
go:
  is_a: ontology term
  represented_as: node
  input_label: go
  inherit_properties: true

# GO subontologies
biological process:
  is_a: go
  represented_as: node
  input_label: biological_process
  inherit_properties: true

molecular function:
  is_a: go
  represented_as: node
  input_label: molecular_function
  inherit_properties: true

cellular component:
  is_a: go
  represented_as: node
  input_label: cellular_component
  inherit_properties: true

parent pathway of:
  is_a: annotation
  inherit_properties: true
  description: >-
    holds between two pathways where the domain class is a parent pathway of the range class
  represented_as: edge
  input_label: parent_pathway_of
  source: pathway
  target: pathway

child pathway of:
  is_a: annotation
  inherit_properties: true
  description: >-
    holds between two pathways where the domain class is a child pathway of the range class
  represented_as: edge
  input_label: child_pathway_of
  source: pathway
  target: pathway


go gene product:
  is_a: annotation
  inherit_properties: true
  represented_as: edge
  input_label: go_gene_product
  properties:
    qualifier: obj
    db_reference: obj
    evidence: str

# GAF adapter
# Data:
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Gene_Association_File_-_GAF_.28gene_association.fb.gz.29
biological process gene product:
  is_a: go gene product
  inherit_properties: true
  represented_as: edge
  input_label: involved_in_biological_process
  # output_label: involved_in
  source: gene
  target: biological process

molecular function gene product:
  is_a: go gene product
  inherit_properties: true
  represented_as: edge
  input_label: enables_go_molecular_function
  # output_label: enables
  source: gene
  target: molecular function

cellular component gene product:
  is_a: go gene product
  inherit_properties: true
  represented_as: edge
  input_label: located_in_cellular_component  # I need to find a better label
  source: gene
  target: cellular component


# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Genes_Sequence_Ontology_.28SO.29_data_.28dmel_gene_sequence_ontology_annotations_fb_.2A.tsv.gz.29
# Used in the sequence_ontology_adapter.py  for dmel data
gene to so:
  is_a: annotation
  inherit_properties: true
  represented_as: edge
  input_label: so_classified_as
  # output_label: belongs_to
  source: gene
  target: so
  properties:
    taxon_id: str   # 7227 for dmel



# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Gene_f_data_.28gene_group_data_fb_.2A.tsv.29
# id is FBgg# for Flybase data
gene group:
  represented_as: node
  input_label: gene_group
  is_a: biological entity
  properties:
    genes: gene[]            # FBgn# list to link the group
    group_symbol: str
    group_name: str
    parent_groups: gene group[]        # FBgg#
    HGNC_family_ID: str[]        # https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Gene_groups_with_HGNC_IDs_.28gene_groups_HGNC_fb_.2A.tsv.29
    taxon_id: int               # 7227 for dmel / 9606 for hsa


gene to group association:
  description: >-
    An association between a gene and a group of genes: genes are grouped into gene groups based on shared characteristics, such as sequence, biological function, or participation in a biological process
  is_a: related to at instance level
  represented_as: edge
  input_label: grouped_into
  source: gene
  target: gene group
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa


# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Signaling_pathway_group_data_.28signaling_pathway_group_data_fb_.2A.tsv.29
# id is FBgg# for Flybase data
signaling pathway gene group:
  represented_as: node
  input_label: signaling_pathway_gene_group
  is_a: biological entity
  properties:
    taxon_id: int               # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)
    genes: gene[]               # FBgn# list to link the group
    group_symbol: str
    group_name: str
    parent_groups: pathway gene group[]        # FBgg#
    HGNC_family_ID: str[]        # https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Gene_groups_with_HGNC_IDs_.28gene_groups_HGNC_fb_.2A.tsv.29


gene to signaling pathway group association:
  description: >-
    An association between a gene and a group of genes: genes are grouped into gene groups based on shared characteristics, such as sequence, biological function, or participation in a biological process
  is_a: related to at instance level
  represented_as: edge
  input_label: signaling_pathway_grouped_into
  source: gene
  target: signaling pathway gene group
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa


# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Metabolic_pathway_group_data_.28metabolic_pathway_group_data_fb_.2A.tsv.29
# id is FBgg# for Flybase data
metabolic pathway gene group:
  represented_as: node
  input_label: metabolic_pathway_gene_group
  is_a: biological entity
  properties:
    taxon_id: int               # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)
    genes: gene[]               # FBgn# list to link the group
    group_symbol: str
    group_name: str
    parent_groups: metabolic pathway gene group[]        # FBgg#
    HGNC_family_ID: str[]        # https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Gene_groups_with_HGNC_IDs_.28gene_groups_HGNC_fb_.2A.tsv.29


gene to metabolic pathway group association:
  description: >-
    An association between a gene and a group of genes: genes are grouped into gene groups based on shared characteristics, such as sequence, biological function, or participation in a biological process
  is_a: related to at instance level
  represented_as: edge
  input_label: metabolic_pathway_grouped_into
  source: gene
  target: metabolic pathway gene group
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa


# FB data: https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Human_disease_model_data_.28disease_model_annotations_fb_.2A.tsv.gz.29
dmel disease model:
  represented_as: node
  input_label: dmel_disease_model
  is_a: biological entity
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa 
    gene: gene        
    do_qualifier: str
    do_term_id: do                       # only this should be enough because of DiseaseOntology
    do_term_name: str
    allele: allele
    ortholog_hgnc_id: str
    ortholog_hgnc_symbol: str             # this should be linked to in the Gene data type
    evidence_code: str                    # evidence code and interacting alleles are in the same field (column) in the tsv file
    interacting_alleles: allele[]         # but they occur *together* very infrequently
    ev_code_interact_alleles: str
    reference_FBrf_id: str


modelled to human disease:
  represented_as: edge
  input_label: modelled_to_human_disease
  is_a: annotation
  source: gene
  target: dmel disease model
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa 


modelled to do term:
  represented_as: edge
  input_label: modelled_to_do_term
  is_a: annotation
  source: gene
  target: do
  properties:
    disease_model_id: dmel disease model
    taxon_id: int                        # 7227 for dmel / 9606 for hsa 


# The following 5 schemata's data source  is

# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Phenotypic_data_.28genotype_phenotype_data_.2A.tsv.29

# From the site above:
# For cases where the genotype contains more than one component, then the components are separated as follows (columns 1 and 2):
#  * Homozygous or transheterozygous combinations of classical/insertional alleles at a single locus are separated by a '/'.
#  * Hemizygous combinations affecting a single locus (classical/insertional allele over a deficiency for that locus) are separated by a '/'.
#  * Heterozygosity for a classical/insertional allele or aberration is represented by '/+'.
#  * In all other cases, other genotype components (e.g. drivers, transgenic alleles) are separated by a space.
#
# genotype and phenotype ids were created to keep original data semantics. They are 'genotype_0', 'phenotype_0', 'genotype_1', 'phenotype_1',...
# It is needed because multiple phenotypes can exist for the same genotype.
genotype:
  represented_as: node
  input_label: genotype
  is_a: biological entity
  properties:
    genotype_ids: str           # string composed of one or more allele id(s) (FBal#)
    genotype_symbols: str       # string composed of one or more allele symbol(s)
    reference: str              # FBrf# literature ref id
    taxon_id: int               # 7227 for dmel / 9606 for hsa


phenotype:
  represented_as: node
  input_label: phenotype
  is_a: biological entity
  properties:
    phenotype_ontology_id: ontology term    # an ontology term ID that chracterizes the phenotype
    taxon_id: int                           # 7227 for dmel / 9606 for hsa 


phenotype to genotype:
  represented_as: edge
  input_label: genetically_informed_by
  is_a: annotation
  source: phenotype
  target: genotype
  properties:
    miniref: str
    fb_ref: str                     # FBrf#
    pmid_ref: str
    pmcid_ref: str
    doi: str
    taxon_id: int                   # 7227 for dmel / 9606 for hsa 


# A phenotype could be characterized by more than one ontology term
phenotype to ontology:
  represented_as: edge
  input_label: characterized_by
  is_a: annotation
  source: phenotype
  target: ontology term       # zero or more FBcv#, FBbt# and/or FBdv to add information to the phenotype.
  properties:
    taxon_id: int             # 7227 for dmel / 9606 for hsa 


# Links an allele (and its gene: an allele is a 'variant_of' a gene) to phenotypes.
allele to phenotype:
  represented_as: edge
  input_label: involved_in
  is_a: annotation
  source: allele
  target: phenotype
  properties:
    miniref: str
    fb_ref: str                     # FBrf#
    pmid_ref: str
    pmcid_ref: str
    doi: str
    taxon_id: int                   # 7227 for dmel / 9606 for hsa 



# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Genetic_interaction_table_.28gene_genetic_interactions_.2A.tsv.29
gene genetic association:
  description: >-
    An association between a gene and another gene, i.e., a gene-level genetic interactions in FlyBase. This data is computed from the allele-level genetic interaction data captured by FlyBase curators.
  is_a: regulatory association
  inherit_properties: true
  represented_as: edge
  input_label: gene_genetic_association
  source: gene
  target: gene
  properties:
    reference: str              # FBrf#
    type: str                # suppresses (“suppressible”) / enhances (“enhanceable”)
    taxon_id: int                        # 7227 for dmel / 9606 for hsa




# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Genetic_interactions_.28allele_genetic_interactions_.2A.tsv.29

# The adapter class extracts any allele symbol occuring in an "interaction_description" property's text and creates
# an edge from the "source allele" given by this node and the allele corresponding to  any allele symbol in the interaction text.
allele to allele genetic interaction: 
  represented_as: edge
  input_label: allele_to_allele_genetic_interaction
  is_a: annotation
  source: allele
  target: allele
  properties:
    interaction_description: str   # FB data record.
    taxon_id: int                        # 7227 for dmel / 9606 for hsa 

